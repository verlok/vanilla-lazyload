const e="undefined"!=typeof window,t=e&&!("onscroll"in window)||"undefined"!=typeof navigator&&/(gle|ing|ro)bot|crawl|spider/i.test(navigator.userAgent),s=e&&"IntersectionObserver"in window,a=e&&"classList"in document.createElement("p"),r={elements_selector:"img",container:t||e?document:null,threshold:300,thresholds:null,data_src:"src",data_srcset:"srcset",data_sizes:"sizes",data_bg:"bg",data_poster:"poster",class_loading:"loading",class_loaded:"loaded",class_error:"error",load_delay:0,auto_unobserve:!0,callback_enter:null,callback_exit:null,callback_reveal:null,callback_loaded:null,callback_error:null,callback_finish:null,use_native:!1};const n=function(e,t){var s;let a=new e(t);try{s=new CustomEvent("LazyLoad::Initialized",{detail:{instance:a}})}catch(e){(s=document.createEvent("CustomEvent")).initCustomEvent("LazyLoad::Initialized",!1,!1,{instance:a})}window.dispatchEvent(s)};const l=(e,t)=>e.getAttribute("data-"+t),o=(e,t,s)=>{var a="data-"+t;null!==s?e.setAttribute(a,s):e.removeAttribute(a)},i=e=>"true"===l(e,"was-processed"),c=(e,t)=>o(e,"ll-timeout",t),d=e=>l(e,"ll-timeout"),_=(e,t,s,a)=>{e&&(void 0===a?void 0===s?e(t):e(t,s):e(t,s,a))},u=(e,t)=>{e.loadingCount+=t,0===e._elements.length&&0===e.loadingCount&&_(e._settings.callback_finish,e)},g=e=>{let t=[];for(let s,a=0;s=e.children[a];a+=1)"SOURCE"===s.tagName&&t.push(s);return t},v=(e,t,s)=>{s&&e.setAttribute(t,s)},h=(e,t)=>{v(e,"sizes",l(e,t.data_sizes)),v(e,"srcset",l(e,t.data_srcset)),v(e,"src",l(e,t.data_src))},m={IMG:(e,t)=>{const s=e.parentNode;if(s&&"PICTURE"===s.tagName){g(s).forEach(e=>{h(e,t)})}h(e,t)},IFRAME:(e,t)=>{v(e,"src",l(e,t.data_src))},VIDEO:(e,t)=>{g(e).forEach(e=>{v(e,"src",l(e,t.data_src))}),v(e,"poster",l(e,t.data_poster)),v(e,"src",l(e,t.data_src)),e.load()}},b=(e,t)=>{const s=t._settings,a=e.tagName,r=m[a];if(r)return r(e,s),u(t,1),void(t._elements=(n=t._elements,o=e,n.filter(e=>e!==o)));var n,o;((e,t)=>{const s=l(e,t.data_src),a=l(e,t.data_bg);s&&(e.style.backgroundImage=`url("${s}")`),a&&(e.style.backgroundImage=a)})(e,s)},f=(e,t)=>{a?e.classList.add(t):e.className+=(e.className?" ":"")+t},p=(e,t)=>{a?e.classList.remove(t):e.className=e.className.replace(new RegExp("(^|\\s+)"+t+"(\\s+|$)")," ").replace(/^\s+/,"").replace(/\s+$/,"")},E=(e,t,s)=>{e.addEventListener(t,s)},w=(e,t,s)=>{e.removeEventListener(t,s)},y=(e,t,s)=>{w(e,"load",t),w(e,"loadeddata",t),w(e,"error",s)},I=function(e,t,s){var a=s._settings;const r=t?a.class_loaded:a.class_error,n=t?a.callback_loaded:a.callback_error,l=e.target;p(l,a.class_loading),f(l,r),_(n,l,s),u(s,-1)},k=(e,t)=>{const s=r=>{I(r,!0,t),y(e,s,a)},a=r=>{I(r,!1,t),y(e,s,a)};((e,t,s)=>{E(e,"load",t),E(e,"loadeddata",t),E(e,"error",s)})(e,s,a)},A=["IMG","IFRAME","VIDEO"],L=(e,t)=>{var s=t._observer;O(e,t),s&&t._settings.auto_unobserve&&s.unobserve(e)},z=e=>{var t=d(e);t&&(clearTimeout(t),c(e,null))},N=(e,t)=>{var s=t._settings.load_delay,a=d(e);a||(a=setTimeout((function(){L(e,t),z(e)}),s),c(e,a))},O=(e,t,s)=>{var a=t._settings;!s&&i(e)||(A.indexOf(e.tagName)>-1&&(k(e,t),f(e,a.class_loading)),b(e,t),(e=>{o(e,"was-processed","true")})(e),_(a.callback_reveal,e,t))},C=e=>{return!!s&&(e._observer=new IntersectionObserver(t=>{t.forEach(t=>(e=>e.isIntersecting||e.intersectionRatio>0)(t)?((e,t,s)=>{const a=s._settings;_(a.callback_enter,e,t,s),a.load_delay?N(e,s):L(e,s)})(t.target,t,e):((e,t,s)=>{const a=s._settings;_(a.callback_exit,e,t,s),a.load_delay&&z(e)})(t.target,t,e))},{root:(t=e._settings).container===document?null:t.container,rootMargin:t.thresholds||t.threshold+"px"}),!0);var t},M=["IMG","IFRAME"],x=(e,t)=>{return(e=>e.filter(e=>!i(e)))((s=e||(e=>e.container.querySelectorAll(e.elements_selector))(t),Array.prototype.slice.call(s)));var s},R=e=>{var t=e._settings;t.container.querySelectorAll("."+t.class_error).forEach(e=>{p(e,t.class_error),(e=>{o(e,"was-processed",null)})(e)}),e.update()},T=function(t,s){var a;this._settings=(e=>Object.assign({},r,e))(t),this.loadingCount=0,C(this),this.update(s),a=this,e&&window.addEventListener("online",e=>{R(a)})};T.prototype={update:function(e){var s,a=this._settings;(this._elements=x(e,a),!t&&this._observer)?((e=>e.use_native&&"loading"in HTMLImageElement.prototype)(a)&&((s=this)._elements.forEach(e=>{-1!==M.indexOf(e.tagName)&&(e.setAttribute("loading","lazy"),O(e,s))}),this._elements=x(e,a)),this._elements.forEach(e=>{this._observer.observe(e)})):this.loadAll()},destroy:function(){this._observer&&(this._elements.forEach(e=>{this._observer.unobserve(e)}),this._observer=null),this._elements=null,this._settings=null},load:function(e,t){O(e,this,t)},loadAll:function(){this._elements.forEach(e=>{L(e,this)})}},e&&function(e,t){if(t)if(t.length)for(let s,a=0;s=t[a];a+=1)n(e,s);else n(e,t)}(T,window.lazyLoadOptions);export default T;
